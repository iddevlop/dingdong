/*
    Build by Suryo DwiJayanto
    Do not remove or clone this
*/
const myhost = "host1"; // ubah ini
const firebaseConfig={apiKey:"AIzaSyABzWrP1Pd7PfboEO4YDD-mmx0G7kdqT04",authDomain:"kodekomen.firebaseapp.com",databaseURL:"https://kodekomen-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"kodekomen",storageBucket:"kodekomen.firebasestorage.app",messagingSenderId:"89330263353",appId:"1:89330263353:web:bd6a9df357d5b3ac5df4e8",measurementId:"G-NZMWLZ2FMN"};firebase.initializeApp(firebaseConfig);const monthhvs=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],xdatehvs=new Date,xhourshvs=xdatehvs.toLocaleTimeString(),xmonthhvs=monthhvs[xdatehvs.getMonth()],xupdhvs=xmonthhvs+" "+xdatehvs.getDate()+", "+xdatehvs.getFullYear()+" "+xhourshvs,xhvsips="https://api.ipify.org?format=json",xhvsipss="https://api.ipinfodb.com/v3/ip-city/?key=601c40a06f860c97800bfd198068c8f6e78876416347373f5c7986784e04dbbd&format=json&ip=",checkAPI=firebase.database().ref("game/dingdong/"+myhost);checkAPI.on("value",e=>{let t=e.val();window.location.hostname==t||fetch("https://api.ipify.org?format=json").then(e=>e.json()).then(e=>{let a=e.ip;fetch("https://api.ipinfodb.com/v3/ip-city/?key=601c40a06f860c97800bfd198068c8f6e78876416347373f5c7986784e04dbbd&format=json&ip="+a).then(e=>e.json()).then(e=>{let n=e.countryCode,l=e.countryName,o=e.regionName,i=e.cityName,s=e.zipCode,r=e.latitude,d=e.longitude,m=e.timeZone,p=firebase.database().ref("game/dingdong/warning").push().key,u=window.location.hostname;firebaseConfig&&(firebase.database().ref("game/dingdong/warning").push().set({ipAddress:a,countryCode:n,countryName:l,regionName:o,cityName:i,zipCode:s,latitude:r,longitude:d,timeZone:m,uniq:p,host:u,date:xupdhvs}),alert("Waduh ada yang maling kode orang sepertinya! klik ok untuk pergi ke situs resminya."),window.location.href="https://"+t+"/dingdong")}).catch(e=>{console.error("Error fetching IP address:",e)})}).catch(e=>{console.error("Error fetching IP address:",e)})});const xmain=document.getElementById("main"),checkMain=firebase.database().ref("game/dingdong/code");checkMain.on("value",e=>{let t=e.val();if(t){xmain.innerHTML=t;let a=document.getElementById("game"),n=document.getElementById("player"),l=document.getElementById("exit"),o=document.getElementById("up"),i=document.getElementById("down"),s=document.getElementById("left"),r=document.getElementById("right"),d=document.getElementById("intro"),m=document.getElementById("startButton"),p=document.getElementById("controls"),u=document.getElementById("myaudio"),c=document.getElementById("light"),h=document.getElementById("gameOverScreen"),y=document.getElementById("gameoverAudio");u.load(),u.play();let $=10,g=10,f=0,b=!1,k=[],_="depan",x=[],v=0,E=20,I=20,j=[{jumlahPeti:5,jumlahHantu:1},{jumlahPeti:6,jumlahHantu:2},{jumlahPeti:7,jumlahHantu:3},{jumlahPeti:8,jumlahHantu:4},{jumlahPeti:9,jumlahHantu:5},{jumlahPeti:10,jumlahHantu:6},{jumlahPeti:11,jumlahHantu:7},{jumlahPeti:12,jumlahHantu:8},{jumlahPeti:13,jumlahHantu:9},{jumlahPeti:14,jumlahHantu:10}];function B(e,t,n){let l=document.createElement("div");return l.classList.add("chest"),l.style.left=e+"px",l.style.top=t+"px",l.adaKunci=n,l.terbuka=!1,a.appendChild(l),l}function P(e,t){let n=document.createElement("div");return n.classList.add("ghost"),n.style.left=e+"px",n.style.top=t+"px",a.appendChild(n),n}function A(){u.play(),d.style.display="none",a.style.display="block",p.style.display="flex",c.style.display="block",f=0,b=!1,$=10,g=10,n.style.left=$+"px",n.style.top=g+"px",l.style.display="none",n.style.backgroundImage="url('human.png')",_="depan";let e=document.querySelectorAll(".chest");e.forEach(e=>e.remove()),k=[];let t=j[v],o=t.jumlahPeti,i=t.jumlahHantu;for(let s=0;s<o;s++){let r=Math.floor(200*Math.random()),m=Math.floor(380*Math.random());k.push(B(r,m,!1))}let h=Math.floor(Math.random()*k.length);k[h].adaKunci=!0,x.forEach(e=>e.remove()),x=[];for(let y=0;y<i;y++){let A=Math.floor(200*Math.random()),H=Math.floor(380*Math.random());x.push(P(A,H))}l.style.left="210px",l.style.top="380px",E=$+10,I=g+10,M(),N()}function H(e,t){b||($+=10*e,g+=10*t,$=Math.max(0,Math.min($,200)),g=Math.max(0,Math.min(g,380)),n.style.left=$+"px",n.style.top=g+"px",e>0?(_="kanan",n.style.backgroundImage="url('faceright.png')",E=$+10,I=g+10):e<0?(_="kiri",n.style.backgroundImage="url('faceleft.png')",E=$-50,I=g+10):(n.style.backgroundImage="url('human.png')",E=$+10,I=g+10),M(),L())}function L(){k.forEach((e,t)=>{20>Math.abs($-parseInt(e.style.left))&&20>Math.abs(g-parseInt(e.style.top))&&!e.terbuka&&(e.terbuka=!0,e.remove(),k.splice(t,1),e.adaKunci?(f++,alert("Kunci ditemukan!"),f>=1&&(l.style.display="block")):alert("Kosong!"))}),x.forEach(e=>{let t=parseInt(e.style.left),a=parseInt(e.style.top);if(20>Math.abs($-t)&&20>Math.abs(g-a)){b=!0,S(),w();return}}),20>Math.abs($-parseInt(l.style.left))&&20>Math.abs(g-parseInt(l.style.top))&&f>=1&&(alert("Selamat, kamu berhasil keluar!"),b=!0,v++,S(),v<j.length?A():window.location.href="")}function w(){h.style.display="flex",y.load(),y.play(),u.pause(),setTimeout(()=>{h.style.display="none",y.pause(),u.load(),u.play(),window.location.href=""},5e3)}function C(){d.style.display="flex",a.style.display="none",p.style.display="none",c.style.display="none"}function N(){x.forEach(e=>{let t=parseInt(e.style.left),n=parseInt(e.style.top),l=.5>Math.random()?-20:20,o=t+l,i=n+(.5>Math.random()?-20:20);o=Math.max(0,Math.min(o,a.offsetWidth-20)),i=Math.max(0,Math.min(i,a.offsetHeight-20)),e.style.left=o+"px",e.style.top=i+"px",l>0?e.style.backgroundImage="url('ghostright.png')":l<0&&(e.style.backgroundImage="url('ghostleft.png')"),e.style.opacity=.1>Math.random()?0:1})}function M(){c.style.left=E+"px",c.style.top=I+"px"}function S(){E=20,I=20,M()}document.addEventListener("keydown",e=>{switch(e.key){case"ArrowUp":H(0,-1);break;case"ArrowDown":H(0,1);break;case"ArrowLeft":H(-1,0);break;case"ArrowRight":H(1,0)}}),o.addEventListener("click",()=>H(0,-1)),i.addEventListener("click",()=>H(0,1)),s.addEventListener("click",()=>H(-1,0)),r.addEventListener("click",()=>H(1,0)),m.addEventListener("click",()=>{confirm("Apakah anda ingin memberikan donasi ke pengembang?")?window.open("https://paypal.me/iyortml"):A()}),setInterval(N,500)}});
